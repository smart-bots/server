!function(){var e={},t=null,n=null,i=null,o=null,r={},a=window.devicePixelRatio||1,l=16*a,c={width:7,height:9,font:10*a+"px arial",color:"#ffffff",background:"#F03D25",fallback:!0,crossOrigin:!0,abbreviate:!0},u=function(){var e=navigator.userAgent.toLowerCase();return function(t){return-1!==e.indexOf(t)}}(),f={ie:u("trident"),chrome:u("chrome"),webkit:u("chrome")||u("safari"),safari:u("safari")&&!u("chrome"),mozilla:u("mozilla")&&!u("chrome")&&!u("safari")},d=function(){for(var e=document.getElementsByTagName("link"),t=0,n=e.length;n>t;t++)if((e[t].getAttribute("rel")||"").match(/\bicon\b/i))return e[t];return!1},m=function(){for(var e=document.getElementsByTagName("link"),t=document.getElementsByTagName("head")[0],n=0,i=e.length;i>n;n++){var o="undefined"!=typeof e[n];o&&(e[n].getAttribute("rel")||"").match(/\bicon\b/i)&&t.removeChild(e[n])}},g=function(){if(!n||!t){var e=d();t=e?e.getAttribute("href"):"/favicon.ico",n||(n=t)}return t},h=function(){return o||(o=document.createElement("canvas"),o.width=l,o.height=l),o},s=function(e){if(e){m();var t=document.createElement("link");t.type="image/x-icon",t.rel="icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}},b=function(e,t){if(!h().getContext||f.ie||f.safari||"force"===r.fallback)return v(e);var n=h().getContext("2d"),t=t||"#000000",o=g();i=document.createElement("img"),i.onload=function(){n.clearRect(0,0,l,l),n.drawImage(i,0,0,i.width,i.height,0,0,l,l),(e+"").length>0&&k(n,e,t),y()},!o.match(/^data/)&&r.crossOrigin&&(i.crossOrigin="anonymous"),i.src=o},v=function(e){if(r.fallback){var t=document.title;"("===t[0]&&(t=t.slice(t.indexOf(" "))),(e+"").length>0?document.title="("+e+") "+t:document.title=t}},k=function(e,t,n){"number"==typeof t&&t>99&&r.abbreviate&&(t=T(t));var i=(t+"").length-1,o=r.width*a+6*a*i,c=r.height*a,u=l-c,d=l-o-a,m=16*a,g=16*a,h=2*a;e.font=(f.webkit?"bold ":"")+r.font,e.fillStyle=r.background,e.strokeStyle=r.background,e.lineWidth=a,e.beginPath(),e.moveTo(d+h,u),e.quadraticCurveTo(d,u,d,u+h),e.lineTo(d,m-h),e.quadraticCurveTo(d,m,d+h,m),e.lineTo(g-h,m),e.quadraticCurveTo(g,m,g,m-h),e.lineTo(g,u+h),e.quadraticCurveTo(g,u,g-h,u),e.closePath(),e.fill(),e.beginPath(),e.strokeStyle="rgba(0,0,0,0.3)",e.moveTo(d+h/2,m),e.lineTo(g-h/2,m),e.stroke(),e.fillStyle=r.color,e.textAlign="right",e.textBaseline="top",e.fillText(t,2===a?29:15,f.mozilla?7*a:6*a)},y=function(){h().getContext&&s(h().toDataURL())},T=function(e){for(var t=[["G",1e9],["M",1e6],["k",1e3]],n=0;n<t.length;++n)if(e>=t[n][1]){e=w(e/t[n][1])+t[n][0];break}return e},w=function(e,t){var n=new Number(e);return n.toFixed(t)};e.setOptions=function(e){r={},e.colour&&(e.color=e.colour);for(var t in c)r[t]=e.hasOwnProperty(t)?e[t]:c[t];return this},e.setImage=function(e){return t=e,y(),this},e.setBubble=function(e,t){return e=e||"",b(e,t),this},e.reset=function(){t=n,s(n)},e.setOptions(c),"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module?module.exports=e:window.Tinycon=e}();